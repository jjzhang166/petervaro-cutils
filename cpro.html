<html><!-- www.cutils.org | Peter Varo | 2014 --><head><link href="http://www.cutils.org/favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="http://www.cutils.org/favicon.ico" rel="icon" type="image/x-icon"/><title>CPRO Profiling</title><meta charset="utf-8"/><link href="css/cdoc.css" rel="stylesheet" type="text/css"/></head><body><div id="column1"><div id="generic"><img src="img/cutils.svg"/><br/><h2><span>MODERN AND LIGHTWEIGHT C UTILITIES</span></h2><p><span>&mdash;</span></p><p><span>DESIGNED BY</span></p><p><span>PETER VARO &copy;2014</span></p><p><span>&mdash;</span></p><br/></div><div id="sidebar"><div><p class="label">Modules:</p></div><br/><a class="toc" href="index.html">CUTILS</a><a class="toc" href="c11.html">C11 Syntax Highlighter</a><a class="toc" href="cref.html">CREF Quick Reference</a><a class="toc" href="cenv.html">CENV Environment Generator</a><a class="toc" href="cdep.html">CDEP Dependeny Graph</a><a class="toc" href="ccom.html">CCOM Comment Scanner</a><a class="toc" href="cver.html">CVER Versioning</a><a class="toc" href="clic.html">CLIC License Comment Generator</a><a class="toc" href="cres.html">CRES External Resources Packer</a><a class="toc" href="carg.html">CARG Variadic Argument Macro</a><a class="toc" href="cbug.html">CBUG Debugging &amp; Logging</a><a class="toc" href="cexc.html">CEXC Exception Handling</a><a class="toc toc_current" href="#">CPRO Profiling</a><a class="toc" href="cutt.html">CUTT Unit Testing Tools</a><a class="toc" href="cdar.html">CDAR Dynamic Array</a><a class="toc" href="cstr.html">CSTR Strings</a><a class="toc" href="csll.html">CSLL Single Linked List</a><a class="toc" href="cdll.html">CDLL Double Linked List</a><a class="toc" href="cmap.html">CMAP HashMap</a><a class="toc" href="cfps.html">CFPS Frame Per Second</a><a class="toc" href="ccol.html">CCOL Color Helper</a><a class="toc" href="cdoc.html">CDOC Documenting Tool</a><br/><div><p class="label">Options:</p><br/><a class="toc" href="#user_Name_Mangling">Name Mangling</a></div><br/><div><p class="label">Functions:</p><br/><a class="toc" href="#func_profile">profile()</a></div></div></div><div id="column2"><div id="content"><h1><span>CPRO | Profiling</span></h1><br/><p><span>A very lightweight debugging/logging single header-only utility,
contains a single function-like macro which can print its
invocation place, a custom message or a formatted message with
values to the standard error output.
</span></p><br/><div><h2 class="title">Options</h2><div class="entity" id="user_Name_Mangling"><p class="name">Name Mangling</p><br/><p class="info"><span>However </span><code>cutils</code><span> uses very short and expressive function names which
are not confronting with any of the standard library's entities,
sometimes one wants to use some of these function, macro or type
names in one's own project for other purposes. To solve this problem
</span><code>cutils</code><span> provides a macro variable, a flag, to turn on or off the
prefixes of the variable names. By default it is turned off.
</span></p><br/></div><p class="info label">Examples:</p><p class="info note"><span>Each public function or function-like macro, or type name will have the same </span><code>cutils_</code><span> prefix, as follows
:</span></p><br/><pre class="info"><code class="snippet"><span></span><span class="code_functions">profile</span><span>();  </span><span class="code_operators">=</span><span></span><span class="code_operators">=</span><span></span><span class="code_operators">=</span><span></span><span class="code_operators">&gt;</span><span>  </span><span class="code_functions">cutils_profile</span><span>();
</span></code></pre><br/><p class="info note"><span>One can compile all files or just some of it, defining the variable through the </span><code>-D</code><span> flag of the compiler, like this
:</span></p><br/><pre class="info"><code class="snippet">cc -std=c11 -Wall -DCUTILS_NAMESPACE -c -o filename.o</code></pre><br/><p class="info note"><span>Or one can define this variable before the inclusion of a header file:</span></p><br/><pre class="info"><code class="snippet"><span></span><span class="code_macros">#define</span><span> CUTILS_NAMESPACE
</span><span class="code_macros">#include</span><span> </span><span class="code_operators">&lt;</span><span>cutils</span><span class="code_operators">/</span><span>cpro</span><span class="code_operators">.</span><span>h</span><span class="code_operators">&gt;</span><span>
</span><span class="code_macros">#undef</span><span> CUTILS_NAMESPACE</span></code></pre><br/></div><div><h2 class="title">Functions</h2><div class="entity" id="func_profile"><p><span class="name">profile</span><span class="space_name_arg_paren"> </span><span class="arg_paren">(</span><span class="space_arg_comma_type"> </span><span class="arg_type">size_t</span><span class="space_arg_type_name"> </span><span class="arg_name">cycles</span><span class="space_arg_name_paren"> </span><span class="arg_comma">,</span><span class="space_arg_comma_type"> </span><span class="arg_type">double</span><span class="space_arg_type_name"> </span><span class="arg_name">time</span><span class="space_arg_name_paren"> </span><span class="arg_comma">,</span><span class="space_arg_comma_type"> </span><span class="arg_type">type(*</span><span class="space_arg_type_name"> </span><span class="arg_name">function</span><span class="space_arg_name_paren"> </span><span class="arg_type">)()</span><span class="space_arg_type_name"> </span><span class="arg_comma">,</span><span class="space_arg_comma_type"> </span><span class="arg_type"></span><span class="space_arg_type_name"> </span><span class="arg_name">...</span><span class="space_arg_name_paren"> </span><span class="arg_paren">)</span></p><br/><p class="info"><span></span><code>profile</code><span> is a function-like macto, which calls </span><code>function</code><span>, </span><code>cycles</code><span>
number of times and measures the time it takes to run, and writes
the average time to </span><code>time</code><span>. If the </span><code>function</code><span> takes arguments, it can
also be provided after the </span><code>function</code><span> argument.
</span></p><br/><p class="info return"><span class="label">Return: </span><code class="return_case"><span>void</span></code></p><br/><p class="info label">Examples:</p><p class="info note"><span>...:</span></p><br/><pre class="info"><code class="snippet"><span></span><span class="code_macros">#include</span><span> </span><span class="code_operators">&lt;</span><span>stdio</span><span class="code_operators">.</span><span>h</span><span class="code_operators">&gt;</span><span>        </span><span class="code_comments">/* printf() */</span><span>
</span><span class="code_macros">#include</span><span> </span><span class="code_operators">&lt;</span><span>cutils</span><span class="code_operators">/</span><span>cpro</span><span class="code_operators">.</span><span>h</span><span class="code_operators">&gt;</span><span>  </span><span class="code_comments">/* profile() */</span><span>

</span><span class="code_keywords">static</span><span> </span><span class="code_types">void</span><span>
</span><span class="code_functions">myfunction</span><span>(</span><span class="code_types">unsigned</span><span> </span><span class="code_types">long</span><span> </span><span class="code_types">long</span><span> </span><span class="code_operators">*</span><span>i)
{
    </span><span class="code_types">unsigned</span><span> </span><span class="code_types">long</span><span> </span><span class="code_types">long</span><span> x </span><span class="code_operators">=</span><span> </span><span class="code_operators">*</span><span>i;
    </span><span class="code_operators">*</span><span>i </span><span class="code_operators">=</span><span> (x</span><span class="code_operators">*</span><span>x </span><span class="code_operators">+</span><span> x</span><span class="code_operators">/</span><span></span><span class="code_numbers">2</span><span> </span><span class="code_operators">+</span><span> x</span><span class="code_operators">/</span><span></span><span class="code_numbers">3</span><span>)</span><span class="code_operators">/</span><span>x;
}

</span><span class="code_types">int</span><span> </span><span class="code_functions">main</span><span>(</span><span class="code_types">void</span><span>)
{
</span><span class="code_macros">    #define</span><span> CYCLES </span><span class="code_numbers">100000000</span><span>
    </span><span class="code_types">double</span><span> time;
    </span><span class="code_types">unsigned</span><span> </span><span class="code_types">long</span><span> </span><span class="code_types">long</span><span> number </span><span class="code_operators">=</span><span> </span><span class="code_numbers">16</span><span>;
    
    </span><span class="code_comments">/* Run myfunction a hundred million times */</span><span>
    </span><span class="code_functions">profile</span><span>(CYCLES, time, myfunction, </span><span class="code_operators">&amp;</span><span>number);
    </span><span class="code_functions">printf</span><span>(</span><span class="code_strings">"To run 'myfunction' for %d times takes %lfs\n"</span><span>, CYCLES, time);
    
    </span><span class="code_keywords">return</span><span> </span><span class="code_numbers">0</span><span>;
}
</span></code></pre><br/><p class="info note"><span>OUTPUT:</span></p><br/><pre class="info"><code class="snippet">To run 'myfunction' for 100000000 times takes 4.901353s</code></pre><br/></div></div></div></div></body></html>